(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20f01e"],{b291:function(t,e,a){"use strict";a.r(e);var s=a("c6a6"),i=a("8336"),l=a("b0af"),r=a("99d9"),n=a("62ad"),o=a("a523"),c=a("8fea"),h=a("169a"),u=a("ce7e"),d=a("132d"),f=a("8860"),p=a("da13"),m=a("34c3"),g=a("5d23"),k=a("e449"),v=a("0fd9"),w=a("2fa4"),y=a("e0c7"),_=a("8654"),I=a("71d9"),b=a("3a2f"),x=function(){var t=this,e=t._self._c;return e(o["a"],[e(y["a"],{staticClass:"pl-0"},[t._v("A simple demo for showing how to build datatable with REST API ")]),e(v["a"],[e(n["a"],{attrs:{cols:"12"}},[e(l["a"],{attrs:{tile:""}},[e(I["a"],{attrs:{flat:""}},[e(_["a"],{attrs:{text:"",solo:"",flat:"","prepend-icon":t.showFilter?"mdi-filter-variant-plus":"mdi-filter-variant","append-icon":"mdi-magnify",placeholder:"Type something","hide-details":"",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleApplyFilter.apply(null,arguments)},"click:append":t.handleApplyFilter,"click:prepend":function(e){t.showFilter=!t.showFilter},"click:clear":t.handleClear},model:{value:t.filter["filter[name]"],callback:function(e){t.$set(t.filter,"filter[name]",e)},expression:"filter['filter[name]']"}}),e(i["a"],{attrs:{icon:""},on:{click:t.handleRefreshItem}},[e(d["a"],[t._v("mdi-refresh")])],1),e(i["a"],{attrs:{icon:""},on:{click:t.handleCreateItem}},[e(d["a"],[t._v("mdi-plus")])],1)],1),e(u["a"]),e(l["a"],{directives:[{name:"show",rawName:"v-show",value:t.showFilter,expression:"showFilter"}],staticClass:"grey lighten-4",attrs:{flat:""}},[e(r["b"],[e(v["a"],[e(n["a"],{attrs:{cols:4}},[e(s["a"],{attrs:{items:t.getProjectList,label:"Project"},model:{value:t.filter["filter[project_id]"],callback:function(e){t.$set(t.filter,"filter[project_id]",e)},expression:"filter['filter[project_id]']"}})],1),e(n["a"],{attrs:{cols:4}},[e(s["a"],{attrs:{items:t.getTaskStatus,label:"Status"},model:{value:t.filter["filter[status]"],callback:function(e){t.$set(t.filter,"filter[status]",e)},expression:"filter['filter[status]']"}})],1)],1)],1),e(r["a"],[e(w["a"]),e(i["a"],{attrs:{text:""},on:{click:t.handleResetFilter}},[t._v("Reset")]),e(i["a"],{attrs:{tile:"",color:"primary"},on:{click:t.handleApplyFilter}},[t._v("Apply")])],1)],1),e(r["b"],{staticClass:"pa-0"},[e(c["a"],{attrs:{loading:t.loadingItems,headers:t.headers,items:t.items,"items-per-page-options":[15,30,50],"server-items-length":t.serverItemsLength,"items-per-page":t.itemsPerPage,page:t.filter["page"],"item-key":"id","show-select":""},on:{"update:page":[function(e){return t.$set(t.filter,"page",e)},t.handlePageChanged]},scopedSlots:t._u([{key:"item.status",fn:function({item:a}){return[e(s["a"],{attrs:{items:t.getTaskStatus},on:{change:function(e){return t.handleUpdateStatus(a,a.status)}},model:{value:a.status,callback:function(e){t.$set(a,"status",e)},expression:"item.status"}})]}},{key:"item.action",fn:function({item:a}){return[e(k["a"],{scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(b["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s}){return[e(i["a"],t._g({attrs:{icon:""}},t.onTooltip({...s,...a})),[e(d["a"],[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[e("span",[t._v("Action")])])]}}],null,!0)},[e(f["a"],{staticClass:"pa-0",attrs:{dense:""}},t._l(t.actions,(function(s){return e(p["a"],{key:s.text,on:{click:function(t){return s.click(a)}}},[e(m["a"],{staticClass:"mr-2"},[e(d["a"],{attrs:{small:""}},[t._v(t._s(s.icon))])],1),e(g["c"],[t._v(t._s(s.text))])],1)})),1)],1)]}}],null,!0)})],1)],1)],1)],1),e(h["a"],{attrs:{scrollable:"",width:"840"},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[e("task-form",{attrs:{item:t.selectedItem},on:{"form:success":t.handleFormSuccess}})],1)],1)},F=[],$=a("aa7e"),j=a("5ee3"),D=a("2f62"),S={components:{TaskForm:j["a"]},mixins:[$["a"]],data(){return{showDialog:!1,search:"",loadingItems:!1,selectedItem:null,serverItemsLength:0,itemsPerPage:15,showFilter:!0,filter:{page:1,"filter[name]":null,"filter[project_id]":null,"filter[status]":null},headers:[{text:"Project",value:"project.name"},{text:"Task",value:"name"},{text:"Description",value:"description"},{text:"slug",value:"slug"},{text:"Status",value:"status",width:100},{text:"Action",value:"action"}],items:[],actions:[{text:"Edit Item",icon:"mdi-pencil",click:this.handleEditItem},{text:"Delete Item",icon:"mdi-close",click:this.handleDeleteItem}]}},computed:{...Object(D["b"])(["getTaskStatus","getProjectList"])},watch:{"$route.query":{handler(t){const e=this.updateFilterQuery(t);this.fetchRecords(e)},immediate:!0}},methods:{updateFilterQuery(t){const e=Object.assign(this.filter,this.transformQuery(t));return e},transformQuery(t){const e=["filter[project_id]","filter[status]","page"];for(let a in t)if(e.includes(a)){const e=t[a]?parseInt(t[a]):t[a];t[a]=e}return t},resetFilter(){this.filter={page:1,"filter[name]":null,"filter[project_id]":null,"filter[status]":null}},fetchRecords(t){return this.loadingItems=!0,this.items=[],this.$store.dispatch("fetchTask",t).then(({data:t,meta:e})=>{this.items=t,this.serverItemsLength=e.total,this.loadingItems=!1}).catch(()=>{this.loadingItems=!1})},handleCreateItem(){this.selectedItem=null,this.showDialog=!0},handleEditItem(t){this.selectedItem=t,this.showDialog=!0},handleDeleteItem({id:t}){window.confirm("Are you sure to delete this")&&this.$store.dispatch("deleteTask",t).then(()=>{this.items=this.items.filter(e=>e.id!=t)})},handleUpdateStatus(t,e){const a={id:t.id,data:{status:e}};this.$store.dispatch("updateTask",a)},handleRefreshItem(){this.fetchRecords(this.filter)},handlePageChanged(t){this.filter.page=t,this.filter.t=Date.now(),this.$router.replace({path:this.$route.path,query:this.filter})},handleResetFilter(){this.filter={page:1,"filter[name]":null,"filter[status]":null},this.$router.replace({path:this.$route.path})},handleApplyFilter(){this.filter.t=Date.now(),this.$router.replace({path:this.$route.path,query:this.filter})},handleClear(){this.resetFilter(),this.filter.t=Date.now(),this.$router.replace({path:this.$route.path,query:this.filter})},handleFormSuccess(){this.showDialog=!1,this.fetchRecords()}}},C=S,P=a("2877"),T=Object(P["a"])(C,x,F,!1,null,null,null);e["default"]=T.exports}}]);